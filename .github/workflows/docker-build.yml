#name: Docker Build and Test
#
#on:
#  push:
#    branches: [ main, dev ]
#  pull_request:
#    branches: [ main, dev ]
#
#jobs:
#  build-backend:
#    runs-on: ubuntu-latest
#    steps:
#      - uses: actions/checkout@v4
#
#      - name: Set up Docker Buildx
#        uses: docker/setup-buildx-action@v3
#
#      - name: Build Backend Image
#        uses: docker/build-push-action@v5
#        with:
#          context: .
#          file: ./Dockerfile
#          push: false
#          tags: meetify-backend:test
#          cache-from: type=gha
#          cache-to: type=gha,mode=max
#
#  build-frontend:
#    runs-on: ubuntu-latest
#    steps:
#      - uses: actions/checkout@v4
#
#      - name: Set up Docker Buildx
#        uses: docker/setup-buildx-action@v3
#
#      - name: Build Frontend Image
#        uses: docker/build-push-action@v5
#        with:
#          context: ./frontend
#          file: ./frontend/Dockerfile
#          push: false
#          tags: meetify-frontend:test
#          cache-from: type=gha
#          cache-to: type=gha,mode=max
#
#  test:
#    runs-on: ubuntu-latest
#    needs: [build-backend, build-frontend]
#    steps:
#      - uses: actions/checkout@v4
#
#      - name: Start services
#        run: docker-compose up -d
#
#      - name: Wait for services
#        run: |
#          timeout 60 bash -c 'until curl -f http://localhost:8080/actuator/health 2>/dev/null; do sleep 2; done'
#          timeout 60 bash -c 'until curl -f http://localhost:3000 2>/dev/null; do sleep 2; done'
#
#      - name: Run backend tests
#        run: docker-compose exec -T backend ./gradlew test
#
#      - name: Check logs
#        if: always()
#        run: docker-compose logs
#
#      - name: Shutdown services
#        if: always()
#        run: docker-compose down -v
